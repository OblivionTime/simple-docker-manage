(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ed8707e4"],{"7fb2":function(t,e,n){"use strict";n("97f5")},"97f5":function(t,e,n){},"9d39":function(t,e,n){"use strict";n("cbc3")},b471:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"header"},[n("el-button",{staticClass:"header-btn",attrs:{icon:"el-icon-plus"},on:{click:function(e){return t.startContainerSumbmit(t.multipleSelection)}}},[t._v("开启")]),n("el-button",{staticClass:"header-btn",attrs:{icon:"el-icon-search"},on:{click:function(e){return t.stopContainerSumbmit(t.multipleSelection)}}},[t._v("暂停")]),n("el-button",{staticClass:"header-btn",attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(e){return t.removeContainerSumbmit(t.multipleSelection)}}},[t._v("删除")])],1),n("div",{staticClass:"content"},[n("div",{staticClass:"table"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),n("el-table-column",{attrs:{prop:"ID",label:"ID",align:"center"}}),n("el-table-column",{attrs:{prop:"name",label:"名称",align:"center"}}),n("el-table-column",{attrs:{prop:"Image",label:"镜像",align:"center"}}),n("el-table-column",{attrs:{prop:"port",label:"端口映射",align:"center"}}),n("el-table-column",{attrs:{prop:"Command",label:"命令执行",align:"center","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"status",label:"状况",align:"center",width:"240"}}),n("el-table-column",{attrs:{prop:"state",label:"运行情况",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"tag",style:t.StateOptions[e.row.state].sty},[t._v(" "+t._s(t.StateOptions[e.row.state].value)+" ")])]}}])}),n("el-table-column",{attrs:{prop:"size",label:"镜像大小",align:"center"}}),n("el-table-column",{attrs:{prop:"createTime",label:"创建时间",align:"center",width:"180","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{label:"实时日志",align:"center",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.openLogDialog(e.row.name)}}},[t._v(" 查看日志 ")])]}}])}),n("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{staticStyle:{"font-size":"25px",color:"#67c23a","margin-right":"10px"},attrs:{type:"text",icon:"el-icon-video-play"},on:{click:function(n){return t.startContainerSumbmit([e.row.name])}}}),n("el-button",{staticStyle:{"font-size":"25px",color:"#e6a23c","margin-right":"10px"},attrs:{type:"text",icon:"el-icon-video-pause"},on:{click:function(n){return t.stopContainerSumbmit([e.row.name])}}}),n("el-button",{staticStyle:{"font-size":"25px",color:"red","margin-right":"10px"},attrs:{type:"text",icon:"el-icon-error"},on:{click:function(n){return t.removeContainerSumbmit([e.row.name])}}}),n("el-dropdown",{staticStyle:{cursor:"pointer"},attrs:{trigger:"click"}},[n("span",{staticClass:"el-dropdown-link"},[n("i",{staticClass:"el-icon-more",staticStyle:{"font-size":"25px",color:"#ced4da",transform:"rotate(90deg)"}})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",[n("div",{on:{click:function(n){return t.openDetailDialog(e.row.name)}}},[n("el-button",{attrs:{type:"text",icon:"el-icon-setting"}},[t._v(" 查看配置 ")])],1)]),n("el-dropdown-item",[n("div",{on:{click:function(n){t.shellDialog=!0,t.currentshellName=e.row.name,t.IsAdmin=!1}}},[n("el-button",{attrs:{type:"text",icon:"el-icon-s-platform"}},[t._v(" 命令行 ")])],1)]),n("el-dropdown-item",[n("div",{on:{click:function(n){t.shellDialog=!0,t.currentshellName=e.row.name,t.IsAdmin=!0}}},[n("el-button",{attrs:{type:"text",icon:"el-icon-s-custom"}},[t._v(" 管理员运行 ")])],1)])],1)],1)]}}])})],1)],1)]),n("el-dialog",{attrs:{title:"容器日志",visible:t.logDialog,top:"10px",width:"80vw"},on:{"update:visible":function(e){t.logDialog=e}}},[n("div",{staticClass:"code",staticStyle:{height:"80vh",overflow:"auto"}},[n("pre",[t._v(" "),t.logDialog?n("code",{staticClass:"language-js line-numbers"},[t._v(t._s(t.currentLog.content))]):t._e()])])]),n("el-dialog",{staticStyle:{height:"93vh",overflow:"auto"},attrs:{title:"容器配置",visible:t.DetailDialog,top:"20px",width:"1200px"},on:{"update:visible":function(e){t.DetailDialog=e}}},[t.DetailDialog?n("INFO",{attrs:{name:t.currentDetailName}}):t._e()],1),n("el-dialog",{staticStyle:{height:"93vh",overflow:"auto"},attrs:{title:"shell",visible:t.shellDialog,top:"20px",width:"1200px"},on:{"update:visible":function(e){t.shellDialog=e}}},[t.shellDialog?n("Shell",{attrs:{name:t.currentshellName,IsAdmin:t.IsAdmin}}):t._e()],1)],1)},i=[],a=n("b85c"),l=(n("d3b7"),n("b0c0"),n("a15b"),n("99af"),n("b775"));function r(t){return Object(l["a"])({url:"/container/list",method:"get",params:t})}function s(t){return Object(l["a"])({url:"/container/detail",method:"get",params:t})}function c(t){return Object(l["a"])({url:"/container/start",method:"post",data:t})}function u(t){return Object(l["a"])({url:"/container/stop",method:"post",data:t})}function d(t){return Object(l["a"])({url:"/container/remove",method:"post",data:t})}var m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-descriptions",{staticClass:"margin-top",attrs:{title:"环境变量",column:1,border:""}},t._l(t.detail.env,(function(e,o){return n("el-descriptions-item",{key:e.key},[n("template",{slot:"label"},[t._v(" "+t._s(e.key)+" ")]),t._v(" "+t._s(e.value)+" ")],2)})),1),n("div",{staticStyle:{margin:"20px 0"}}),n("el-descriptions",{staticClass:"margin-top",attrs:{title:"端口暴露",column:1,border:""}},t._l(t.detail.exposed_ports,(function(e,o){return n("el-descriptions-item",{key:e.key},[n("template",{slot:"label"},[t._v(" "+t._s(e.key)+" ")]),t._v(" "+t._s(e.value)+" ")],2)})),1),n("div",{staticStyle:{margin:"20px 0"}}),n("el-descriptions",{staticClass:"margin-top",attrs:{title:"目录挂载",column:1,border:""}},t._l(t.detail.mounts,(function(e,o){return n("el-descriptions-item",{key:e.key},[n("template",{slot:"label"},[t._v(" "+t._s(e.key)+" ")]),t._v(" "+t._s(e.value)+" ")],2)})),1),n("div",{staticStyle:{margin:"20px 0"}}),n("el-descriptions",{staticClass:"margin-top",attrs:{title:"网络",column:1,border:""}},t._l(t.detail.networkConfig,(function(e,o){return n("el-descriptions-item",{key:e.key},[n("template",{slot:"label"},[t._v(" "+t._s(e.key)+" ")]),t._l(e.value,(function(e){return n("div",[n("el-tag",[t._v(t._s(e))])],1)}))],2)})),1)],1)},f=[],g={name:"info",props:{name:{type:String}},data:function(){return{detail:{}}},created:function(){this.loadData()},methods:{loadData:function(){var t=this;s({containerId:this.name}).then((function(e){0==e.code&&(t.detail=e.data)}))}}},h=g,p=(n("9d39"),n("2877")),b=Object(p["a"])(h,m,f,!1,null,"42b01638",null),v=b.exports,w=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},y=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"xterm",attrs:{id:"xterm"}})])}],k=(n("abb2"),n("fcf3")),_=n("47d0"),S=n("173c"),x={name:"Xterm",props:{name:{type:String},IsAdmin:{type:Boolean}},created:function(){var t="";t=window.location.host,this.IsAdmin?this.socketURI="ws://"+t+"/api/docker/v1/container/shell?name="+this.name+"&user=root&hostname="+this.$store.getters.hostname:this.socketURI="ws://"+t+"/api/docker/v1/container/shell?name="+this.name+"&hostname="+this.$store.getters.hostname},data:function(){return{socketURI:"",windowWidth:document.documentElement.clientWidth,windowHeight:document.documentElement.clientHeight}},mounted:function(){var t=this;this.initSocket(),window.onresize=function(){return function(){window.fullHeight=document.documentElement.clientHeight,window.fullWidth=document.documentElement.clientWidth,t.windowHeight=window.fullHeight,t.windowWidth=window.fullWidth}()}},destroyed:function(){this.socket.close(),this.term.dispose()},watch:{windowHeight:function(t){var e=Math.floor(this.windowHeight/23),n=Math.floor(this.windowWidth/13);console.log(e,n),this.term.resize(n,e)},windowWidth:function(t){var e=Math.floor(this.windowHeight/23),n=Math.floor(this.windowWidth/13);this.term.resize(n,e)}},methods:{initTerm:function(){var t=Math.floor(this.windowHeight/23),e=Math.floor(this.windowWidth/13),n=new k["Terminal"]({rendererType:"canvas",rows:t,cols:e,fontSize:16,cursor_style:"block",cursorBlink:!0,theme:{foreground:"#ECECEC",background:"#000000",cursor:"help",lineHeight:20}}),o=new S["AttachAddon"](this.socket),i=new _["FitAddon"],a=document.getElementById("xterm");n.open(a),n.loadAddon(o),n.loadAddon(i),i.fit(),n.focus(),this.term=n},initSocket:function(){this.socket=new WebSocket(this.socketURI),this.socketOnClose(),this.socketOnOpen(),this.socketOnError()},socketOnOpen:function(){var t=this;this.socket.onopen=function(){t.initTerm()}},socketOnClose:function(){this.socket.onclose=function(){}},socketOnError:function(){this.socket.onerror=function(){}}}},D=x,C=Object(p["a"])(D,w,y,!1,null,null,null),L=C.exports,O={name:"container",components:{INFO:v,Shell:L},data:function(){return{tableData:[],loading:!0,StateOptions:{created:{value:"已创建",sty:"background-color: #ecf5ff;border-color: #d9ecff;color: #409eff;"},running:{value:"运行中",sty:"background-color: #f0f9eb;border-color: #e1f3d8;color: #67c23a;"},paused:{value:"已暂停",sty:"background-color: #f4f4f5;border-color: #e9e9eb;color: #909399;"},restarting:{value:"重启中",sty:"background-color: #fdf6ec;border-color: #faecd8;color: #e6a23c;"},removing:{value:"移除中",sty:"background-color: #fdf6ec;border-color: #faecd8;color: #e6a23c;"},exited:{value:"已退出",sty:"background-color: #fef0f0;border-color: #fde2e2;color: #f56c6c;"},dead:{value:"已停止",sty:"background-color: #fef0f0;border-color: #fde2e2;color: #f56c6c;"}},multipleSelection:[],LogList:[],logDialog:!1,currentLog:{},DetailDialog:!1,currentDetailName:"",shellDialog:!1,currentshellName:"",IsAdmin:!1}},mounted:function(){this.loadData(),Prism.highlightAll()},methods:{loadData:function(){var t=this;this.loading=!0,r({page:1}).then((function(e){var n=[];0===e.code&&(n=e.data),t.tableData=n})).finally((function(){t.loading=!1}))},handleSelectionChange:function(t){var e,n=[],o=Object(a["a"])(t);try{for(o.s();!(e=o.n()).done;){var i=e.value;n.push(i.name)}}catch(l){o.e(l)}finally{o.f()}this.multipleSelection=n},startContainerSumbmit:function(t){var e=this,n=this.$createElement;this.$msgbox({title:"消息",message:n("p",null,[n("span",null,"此操作将启动 "),n("span",{style:"color: red"},t.join(",")),n("span",null,"容器,是否继续?")]),showCancelButton:!0,confirmButtonText:"启动",cancelButtonText:"取消",type:"warning"}).then((function(){var n=e.$loading({lock:!0,text:"Loading.....",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});c({containers:t}).then((function(t){var n,o="",i=Object(a["a"])(t.data);try{for(i.s();!(n=i.n()).done;){var l=n.value;o+="".concat(l.containerId,"发送错误,错误原因:").concat(l.message,"<br/>")}}catch(r){i.e(r)}finally{i.f()}o?e.$notify.error({title:"错误",dangerouslyUseHTMLString:!0,message:o}):e.$message.success("启动容器成功"),e.loadData()})).finally((function(){n.close()}))}))},stopContainerSumbmit:function(t){var e=this,n=this.$createElement;this.$msgbox({title:"消息",message:n("p",null,[n("span",null,"此操作将暂停"),n("span",{style:"color: red"},t.join(",")),n("span",null,"容器,是否继续?")]),showCancelButton:!0,confirmButtonText:"暂停",cancelButtonText:"取消",type:"warning"}).then((function(){var n=e.$loading({lock:!0,text:"Loading.....",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});u({containers:t}).then((function(t){var n,o="",i=Object(a["a"])(t.data);try{for(i.s();!(n=i.n()).done;){var l=n.value;o+="".concat(l.containerId,"发送错误,错误原因:").concat(l.message,"<br/>")}}catch(r){i.e(r)}finally{i.f()}o?e.$notify.error({title:"错误",dangerouslyUseHTMLString:!0,message:o}):e.$message.success("暂停容器成功"),e.loadData()})).finally((function(){n.close()}))}))},removeContainerSumbmit:function(t){var e=this,n=this.$createElement;this.$msgbox({title:"消息",message:n("p",null,[n("span",null,"此操作将删除 "),n("span",{style:"color: red"},t.join(",")),n("span",null,"容器,是否继续?")]),showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then((function(){var n=e.$loading({lock:!0,text:"Loading.....",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});d({containers:t}).then((function(t){var n,o="",i=Object(a["a"])(t.data);try{for(i.s();!(n=i.n()).done;){var l=n.value;o+="".concat(l.containerId,"发送错误,错误原因:").concat(l.message,"<br/>")}}catch(r){i.e(r)}finally{i.f()}o?e.$notify.error({title:"错误",dangerouslyUseHTMLString:!0,message:o}):e.$message.success("删除容器成功"),e.loadData()})).finally((function(){n.close()}))}))},openLogDialog:function(t){var e=this;if(this.LogList[t])this.currentLog=this.LogList[t],this.logDialog=!0;else{var n=this.$loading({lock:!0,text:"Loading.....",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),o="";o=window.location.host;var i=new WebSocket("ws://"+o+"/api/docker/v1/container/logs?name="+t+"&hostname="+this.$store.getters.hostname);i.onopen=function(){e.LogList[t]={LogWebsocket:i,content:"",name:t},e.currentLog=e.LogList[t],e.logDialog=!0,n.close()},i.onmessage=function(n){var o=n.data,i=e.LogList[t];i.content+=o,e.$set(e.LogList,t,i),e.currentLog.name==i.name&&(e.$set(e.currentLog,"content",i.content),setTimeout((function(){Prism.highlightAll()}),50))}}},openDetailDialog:function(t){this.currentDetailName=t,this.DetailDialog=!0}}},$=O,I=(n("7fb2"),Object(p["a"])($,o,i,!1,null,"2762d485",null));e["default"]=I.exports},b775:function(t,e,n){"use strict";n("d3b7");var o=n("bc3a"),i=n.n(o),a=n("4360"),l=n("a18c"),r=n("5c96"),s="/api/docker/v1/",c=i.a.create({baseURL:s,timeout:5e4});c.interceptors.request.use((function(t){return a["a"].getters.hostname&&(t.headers["hostname"]=a["a"].getters.hostname),t}),(function(t){return Promise.reject(t)})),c.interceptors.response.use((function(t){if(401!=t.data.code)return t.data;Object(r["Message"])({message:t.data.message,type:"error",duration:1500,onClose:function(){setTimeout((function(){l["a"].push("/")}),1500)}})}),(function(t){console.log(t)})),e["a"]=c},cbc3:function(t,e,n){}}]);